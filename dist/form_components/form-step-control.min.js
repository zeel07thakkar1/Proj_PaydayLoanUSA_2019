function nextStep(s,t){var a=Number(s.closest("[data-step]").data("step"));a=++a,(void 0!==t&&t||$("[data-step="+a+"]").hasClass("skip"))&&$(".find-user[data-step]").length&&($("[data-step="+a+"]").addClass("skip"),a=++a),goToStep(a,"forward",s)}function prevStep(s){var t=Number(s.closest("[data-step]").data("step"));t=--t,$("[data-step="+t+"]").hasClass("skip")&&(t=--t),goToStep(t,"backward",s)}function goToStep(s,t,a){$("[data-step="+s+"]").hasClass("final-step")||resetHelpText(),$("[data-step="+s+"]").hasClass("future")?$("main").addClass("mobile-small-header"):$("main").removeClass("mobile-small-header"),void 0===t?t="":"forward"==t&&$(".current-step[data-step]").addClass("valid"),$(".current-step[data-step]").removeClass("current-step"),$("[data-step="+s+"]").addClass("current-step"),void 0===a||bowser.msie&&bowser.version<=8||a.closest("[data-step]").validator("destroy"),$.event.trigger({type:"goToStep",step:s,direction:t})}function valid(s){var t=!0,a=s.closest("[data-step]");return a.validator("validate"),a.find(".form-group").each(function(){$(this).hasClass("has-error")&&(t=!1)}),a.validator("destroy"),t}var destroy_validator=!0;$(function(){$("[data-step]:first:visible").addClass("current-step"),$(".next-step").click(function(s){s.stopPropagation();var t=$(this);$(this).closest("[data-step]").find(".suppress-error").removeClass("suppress-error"),$(this).closest("[data-step]").find(".birthday-overlay, .ssn-overlay").removeClass("is-empty");var a=!1;if(t.hasClass("final-step")?(t.closest("form").validator("validate"),$(".suppress-error").removeClass("suppress-error"),a=t.closest("form").find(".form-group.has-error").length,a||t.hasClass("submit-disabled")||(t.addClass("submit-disabled"),t.html("Processing..."),$('[name="browser_time"]').val(moment().toISOString(!0)),submitForm())):(a=t.closest("[data-step]").find(".form-group.has-error").length,a||(t.closest("[data-step]").validator("validate"),a=t.closest("[data-step]").find(".form-group.has-error").length),a||t.hasClass("prevent-submit")||(t.hasClass("first-next-step")&&!t.hasClass("disable-submit")?(t.addClass("disable-submit"),$.event.trigger({type:"lookupProcessing",el:t}),$.ajax({url:"/apply-populate",type:"POST",dataType:"json",data:$(".apply-form").serialize(),success:function(s){s?location.replace("/apply"):nextStep(t,!0)},error:function(s){nextStep(t,!0)}})):nextStep(t))),a)if($(".apply-form").hasClass("logged-in"))t.closest(".apply-form").find(".has-error :input:first").length&&$("html, body").animate({scrollTop:t.closest(".apply-form").find(".has-error :input:first").offset().top-20},250);else{var e=t.closest("form").find(".has-error").first().closest("[data-step]");e.find(".has-error :input:first").length&&(goToStep(e.data("step")),$("html, body").animate({scrollTop:e.find(".has-error :input:first").offset().top-20},250))}}),$(".prev-step").click(function(s){s.stopPropagation(),valid($(this).closest("[data-step]"))||$(".current-step[data-step]").removeClass("valid"),prevStep($(this))}),$("[data-step]").click(function(){if(!$(this).hasClass("current-step")&&!$(".apply-form").hasClass("logged-in")){var s=$(".current-step[data-step]").data("step"),t=$(this).data("step"),a=t>s?"forward":"backward";"forward"==a?valid($(".current-step[data-step]"))&&$(this).data("step")<=$(".valid[data-step]:last").next("[data-step]").data("step")&&goToStep($(this).data("step"),a):(valid($(".current-step[data-step]"))||($(".current-step[data-step]").removeClass("valid"),$(".current-step[data-step]").nextAll("[data-step]").removeClass("valid")),goToStep($(this).data("step"),a))}})});